@echo off
@echo 开始替换！

echo iLocal=LCase("c:\hosts") >> download.vbs
echo iRemote=LCase("https://raw.githubusercontent.com/racaljk/hosts/master/hosts") >> download.vbs

echo Set xPost=createObject("Microsoft.XMLHTTP") 'Set Post = CreateObject("Msxml2.XMLHTTP") >> download.vbs
echo xPost.Open "GET",iRemote,0 >> download.vbs
echo xPost.Send() >> download.vbs
echo set sGet=createObject("ADODB.Stream") >> download.vbs
echo sGet.Mode=3 >> download.vbs
echo sGet.Type=1 >> download.vbs
echo sGet.Open() >> download.vbs
echo sGet.Write xPost.ResponseBody >> download.vbs
echo sGet.SaveToFile iLocal,2 >> download.vbs
cd /d %~dp0
ping 127.0.0.1 > nul
 download.vbs


ping 127.0.0.1 > nul
ping 127.0.0.1 > nul

ping 127.0.0.1 > nul
move C:\WINDOWS\system32\drivers\etc\hosts c:\windows
set filename=%date:~0,4%%date:~5,2%%date:~8,2%%time:~0,2%%time:~3,2%%time:~6,2%
ren C:\windows\hosts %filename%.bak
@echo %filename%.bak >> hostbak.txt
pause
@echo hosts文件已经备份到c盘windows，名字为当前的时间，例如20160212182118.bak ，而且保存到了hostsbak.txt里

move c:\hosts C:\WINDOWS\system32\drivers\etc\
@echo hosts替换成功
ipconfig /flushdns
pause
start https://www.google.com.hk
@echo 测试
del download.vbs /s /q
pause
